<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>jh-infodose ¬∑ Or√ßamento & Contrato</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    /* MOBILE-FIRST VERTICAL HARD-LOCK */
    :root {
      --nebula-grad-a: #f0f;
      --nebula-grad-b: #0ff;
      --kob-bg: #020812;
      --kob-panel: #050d18;
      --kob-ink: #eafcff;
      --kob-muted: #8ac7dd;
      --kob-accent: #00ffd0;
      --kob-accent-soft: rgba(0, 255, 208, 0.16);
      --kob-danger: #ff4b81;
      --radius-lg: 16px;
      --radius-md: 10px;
      --shadow-soft: 0 16px 40px rgba(0, 0, 0, 0.6);
      --shadow-chip: 0 0 0 1px rgba(255, 255, 255, 0.12);
      --gap: 14px;
      --font-main: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html, body {
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at top, rgba(240, 0, 255, 0.2), transparent 55%),
                  radial-gradient(circle at bottom, rgba(0, 255, 255, 0.18), transparent 55%),
                  var(--kob-bg);
      color: var(--kob-ink);
      font-family: var(--font-main);
      -webkit-font-smoothing: antialiased;
    }

    body {
      display: flex;
      justify-content: center;
    }

    .jh-shell {
      width: 100%;
      max-width: 480px;
      padding: 18px 16px 40px;
    }

    .jh-card {
      background: linear-gradient(135deg, rgba(240, 0, 255, 0.12), rgba(0, 255, 255, 0.06)),
                  var(--kob-panel);
      border-radius: 24px;
      box-shadow: var(--shadow-soft);
      padding: 18px 16px 20px;
      display: flex;
      flex-direction: column;
      gap: 16px;
      border: 1px solid rgba(255, 255, 255, 0.06);
    }

    .jh-header {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .jh-badge {
      align-self: flex-start;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(0, 0, 0, 0.24);
      border: 1px solid rgba(255, 255, 255, 0.16);
      font-size: 11px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--kob-muted);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .jh-badge-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: radial-gradient(circle, #0ff, #00ffd0);
      box-shadow: 0 0 8px rgba(0, 255, 208, 0.8);
    }

    .jh-title {
      font-size: 20px;
      font-weight: 650;
    }

    .jh-subtitle {
      font-size: 13px;
      color: var(--kob-muted);
      line-height: 1.5;
    }

    .jh-section {
      padding: 12px 10px;
      border-radius: 18px;
      background: rgba(2, 8, 18, 0.66);
      border: 1px solid rgba(255, 255, 255, 0.08);
      display: flex;
      flex-direction: column;
      gap: var(--gap);
    }

    .jh-section-title {
      font-size: 13px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      color: var(--kob-muted);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .jh-section-title span {
      font-size: 10px;
    }

    .jh-grid {
      display: flex;
      flex-direction: column;
      gap: var(--gap);
    }

    .jh-field {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .jh-label-line {
      display: flex;
      justify-content: space-between;
      gap: 6px;
      font-size: 12px;
      color: var(--kob-muted);
    }

    .jh-label-main {
      font-weight: 500;
      color: var(--kob-ink);
    }

    .jh-label-hint {
      font-size: 11px;
      opacity: 0.85;
    }

    .jh-input,
    .jh-textarea,
    .jh-select {
      width: 100%;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.14);
      padding: 10px 12px;
      font-size: 13px;
      background: rgba(1, 7, 16, 0.92);
      color: var(--kob-ink);
      outline: none;
      box-shadow: var(--shadow-chip);
    }

    .jh-input::placeholder,
    .jh-textarea::placeholder {
      color: rgba(138, 199, 221, 0.75);
    }

    .jh-input:focus,
    .jh-textarea:focus,
    .jh-select:focus {
      border-color: var(--kob-accent);
      box-shadow: 0 0 0 1px rgba(0, 255, 208, 0.4);
    }

    .jh-input[type="number"] {
      -moz-appearance: textfield;
    }

    .jh-input::-webkit-outer-spin-button,
    .jh-input::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }

    .jh-select {
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      padding-right: 30px;
      background-image:
        linear-gradient(45deg, transparent 50%, #0ff 50%),
        linear-gradient(135deg, #0ff 50%, transparent 50%);
      background-position:
        calc(100% - 18px) 14px,
        calc(100% - 12px) 14px;
      background-size: 6px 6px, 6px 6px;
      background-repeat: no-repeat;
    }

    .jh-row-inline {
      display: flex;
      flex-direction: column;
      gap: var(--gap);
    }

    .jh-pill-row {
      display: flex;
      flex-wrap: nowrap;
      overflow-x: auto;
      gap: 8px;
      padding-bottom: 2px;
    }

    .jh-pill {
      flex: 0 0 auto;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(0, 255, 208, 0.12);
      border: 1px solid rgba(0, 255, 208, 0.35);
      font-size: 11px;
      color: var(--kob-muted);
      white-space: nowrap;
    }

    .jh-highlight {
      font-size: 18px;
      font-weight: 650;
      background: linear-gradient(135deg, #0ff, #f0f);
      -webkit-background-clip: text;
      color: transparent;
    }

    .jh-summary-line {
      display: flex;
      justify-content: space-between;
      font-size: 13px;
      padding: 4px 0;
      border-bottom: 1px dashed rgba(255, 255, 255, 0.08);
    }

    .jh-summary-line:last-child {
      border-bottom: none;
    }

    .jh-summary-label {
      color: var(--kob-muted);
    }

    .jh-summary-value {
      font-weight: 500;
    }

    .jh-btn-main {
      width: 100%;
      border-radius: 999px;
      padding: 11px 16px;
      font-size: 14px;
      font-weight: 600;
      border: none;
      outline: none;
      cursor: pointer;
      background: radial-gradient(circle at top left, rgba(240, 0, 255, 0.7), transparent 50%),
                  radial-gradient(circle at bottom right, rgba(0, 255, 255, 0.7), transparent 50%),
                  linear-gradient(135deg, #f0f, #0ff);
      color: #020812;
      box-shadow: 0 12px 32px rgba(0, 0, 0, 0.8);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .jh-btn-main span.icon {
      font-size: 15px;
    }

    .jh-btn-secondary {
      width: 100%;
      margin-top: 6px;
      border-radius: 999px;
      padding: 9px 14px;
      font-size: 13px;
      font-weight: 500;
      border: 1px solid rgba(0, 255, 208, 0.5);
      background: rgba(2, 8, 18, 0.85);
      color: var(--kob-ink);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
    }

    .jh-btn-secondary span.icon {
      font-size: 14px;
    }

    .jh-textarea {
      border-radius: 14px;
      min-height: 160px;
      resize: vertical;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      line-height: 1.45;
    }

    .jh-note {
      font-size: 11px;
      color: var(--kob-muted);
      line-height: 1.4;
    }

    .jh-note strong {
      color: var(--kob-ink);
    }

    @media (min-width: 520px) {
      .jh-card {
        padding: 20px 18px 22px;
      }
    }
  </style>
</head>
<body>
  <div class="jh-shell" id="jh-infodose-orc">
    <div class="jh-card">
      <header class="jh-header">
        <div class="jh-badge">
          <span class="jh-badge-dot"></span>
          jh-infodose ¬∑ Or√ßamento & Contrato
        </div>
        <h1 class="jh-title">Gerador de Or√ßamento Integrado</h1>
        <p class="jh-subtitle">
          Engenharia de Seguran√ßa + Engenharia Civil + Dual Infodose.  
          Escolha o modo, preencha os dados e gere o <strong>Or√ßamento (Markdown)</strong> e a <strong>Minuta de Contrato</strong> em um clique.
        </p>
      </header>

      <!-- MODO DO OR√áAMENTO -->
      <section class="jh-section">
        <div class="jh-section-title">
          <span>‚óè</span> Modo do or√ßamento
        </div>
        <div class="jh-grid">
          <div class="jh-field">
            <div class="jh-label-line">
              <span class="jh-label-main">Modo</span>
              <span class="jh-label-hint">Pacote integrado √ó Hora t√©cnica</span>
            </div>
            <select id="jh-modo" class="jh-select">
              <option value="pacote">Pacote de diagn√≥stico integrado</option>
              <option value="hora">Servi√ßos cont√≠nuos por hora t√©cnica</option>
            </select>
          </div>
        </div>
      </section>

      <!-- DADOS DO CLIENTE / CONSULTOR -->
      <section class="jh-section">
        <div class="jh-section-title">
          <span>‚óè</span> Dados do cliente e do consultor
        </div>
        <div class="jh-grid">
          <div class="jh-field">
            <div class="jh-label-line">
              <span class="jh-label-main">Nome da empresa (Contratante)</span>
              <span class="jh-label-hint">Cliente / raz√£o social</span>
            </div>
            <input id="jh-nome-empresa" class="jh-input" type="text" placeholder="Ex: Alfa Ind√∫stria de Componentes LTDA" />
          </div>

          <div class="jh-field">
            <div class="jh-label-line">
              <span class="jh-label-main">Cidade / UF da empresa</span>
              <span class="jh-label-hint">Local da opera√ß√£o</span>
            </div>
            <!-- input com datalist de cidades SP + valor padr√£o Sorocaba -->
            <input
              id="jh-local"
              class="jh-input"
              type="text"
              list="jh-cidades-sp"
              placeholder="Ex: Sorocaba / SP"
              value="Sorocaba / SP"
            />
            <datalist id="jh-cidades-sp">
              <option value="Sorocaba / SP"></option>
              <option value="S√£o Paulo / SP"></option>
              <option value="Jundia√≠ / SP"></option>
              <option value="Campinas / SP"></option>
              <option value="Santos / SP"></option>
              <option value="S√£o Jos√© dos Campos / SP"></option>
              <option value="Ribeir√£o Preto / SP"></option>
            </datalist>
          </div>

          <div class="jh-field">
            <div class="jh-label-line">
              <span class="jh-label-main">Resumo do cen√°rio</span>
              <span class="jh-label-hint">Breve descri√ß√£o da opera√ß√£o</span>
            </div>
            <input id="jh-resumo" class="jh-input" type="text" placeholder="Ex: F√°brica com 40 colaboradores, 2 turnos, opera√ß√£o cont√≠nua." />
          </div>

          <div class="jh-field">
            <div class="jh-label-line">
              <span class="jh-label-main">Consultor / Empresa (Contratada)</span>
              <span class="jh-label-hint">Seu nome ou da sua empresa</span>
            </div>
            <input id="jh-consultor-nome" class="jh-input" type="text" placeholder="Ex: JH Engenharia & Infodose" />
          </div>

          <div class="jh-field">
            <div class="jh-label-line">
              <span class="jh-label-main">Documento da contratada</span>
              <span class="jh-label-hint">CPF/CNPJ para o contrato</span>
            </div>
            <input id="jh-consultor-doc" class="jh-input" type="text" placeholder="Ex: CNPJ 00.000.000/0001-00" />
          </div>
        </div>
      </section>

      <!-- VALORES ENGENHARIA -->
      <section class="jh-section">
        <div class="jh-section-title">
          <span>‚óè</span> Engenharia &amp; Seguran√ßa
        </div>
        <div class="jh-grid">
          <div class="jh-field">
            <div class="jh-label-line">
              <span class="jh-label-main">Eng. Seguran√ßa do Trabalho</span>
              <span class="jh-label-hint">Hora t√©cnica (R$) + horas previstas</span>
            </div>
            <div class="jh-row-inline">
              <input
                id="jh-hr-seg"
                class="jh-input"
                type="number"
                step="0.01"
                placeholder="Ex: 220"
                value="220"
              />
              <input
                id="jh-horas-seg"
                class="jh-input"
                type="number"
                step="0.1"
                placeholder="Ex: 4"
                value="4"
              />
            </div>
          </div>

          <div class="jh-field">
            <div class="jh-label-line">
              <span class="jh-label-main">Eng. Civil</span>
              <span class="jh-label-hint">Hora t√©cnica (R$) + horas previstas</span>
            </div>
            <div class="jh-row-inline">
              <input
                id="jh-hr-civil"
                class="jh-input"
                type="number"
                step="0.01"
                placeholder="Ex: 200"
                value="200"
              />
              <input
                id="jh-horas-civil"
                class="jh-input"
                type="number"
                step="0.1"
                placeholder="Ex: 4"
                value="4"
              />
            </div>
          </div>
        </div>
      </section>

      <!-- INFODOSE / PLANOS -->
      <section class="jh-section">
        <div class="jh-section-title">
          <span>‚óè</span> Dual Infodose &amp; Planos
        </div>

        <div class="jh-grid">
          <div class="jh-field">
            <div class="jh-label-line">
              <span class="jh-label-main">Setup Dual Infodose + Livro Vivo</span>
              <span class="jh-label-hint">Pacote fixo (R$)</span>
            </div>
            <input
              id="jh-setup-infodose"
              class="jh-input"
              type="number"
              step="0.01"
              placeholder="Ex: 1800"
              value="1800"
            />
          </div>

          <div class="jh-field">
            <div class="jh-label-line">
              <span class="jh-label-main">Acompanhamento mensal (opcional)</span>
              <span class="jh-label-hint">Mensalidade (R$)</span>
            </div>
            <input
              id="jh-mensal"
              class="jh-input"
              type="number"
              step="0.01"
              placeholder="Ex: 900"
              value="900"
            />
          </div>

          <div class="jh-pill-row">
            <div class="jh-pill">+ Gin√°stica ergon√¥mica ligada ao diagn√≥stico</div>
            <div class="jh-pill">+ Relat√≥rios em Markdown / Infod0x</div>
            <div class="jh-pill">+ Evid√™ncias para auditorias e a√ß√µes trabalhistas</div>
          </div>
        </div>
      </section>

      <!-- RESUMO NUM√âRICO -->
      <section class="jh-section">
        <div class="jh-section-title">
          <span>‚óè</span> Resumo de valores
        </div>

        <div class="jh-grid">
          <div class="jh-summary-line">
            <span class="jh-summary-label">Eng. Seguran√ßa (total)</span>
            <span id="jh-out-seg" class="jh-summary-value">R$ 0,00</span>
          </div>
          <div class="jh-summary-line">
            <span class="jh-summary-label">Eng. Civil (total)</span>
            <span id="jh-out-civil" class="jh-summary-value">R$ 0,00</span>
          </div>
          <div class="jh-summary-line">
            <span class="jh-summary-label">Setup Dual Infodose</span>
            <span id="jh-out-setup" class="jh-summary-value">R$ 0,00</span>
          </div>
          <div class="jh-summary-line">
            <span class="jh-summary-label">Diagn√≥stico / Entrada (sem mensalidade)</span>
            <span id="jh-out-total" class="jh-summary-value jh-highlight">R$ 0,00</span>
          </div>
          <div class="jh-summary-line">
            <span class="jh-summary-label">+ 3 meses de acompanhamento</span>
            <span id="jh-out-total-3m" class="jh-summary-value">R$ 0,00</span>
          </div>
        </div>
        <p class="jh-note">
          No modo <strong>Pacote</strong>, o valor de entrada resume o diagn√≥stico integrado.  
          No modo <strong>Hora t√©cnica</strong>, ele funciona como estimativa inicial de horas + setup.
        </p>
      </section>

      <!-- MARKDOWN OR√áAMENTO -->
      <section class="jh-section">
        <div class="jh-section-title">
          <span>‚óè</span> Markdown ¬∑ Or√ßamento (Livro Vivo / Infod0x)
        </div>
        <div class="jh-grid">
          <textarea id="jh-markdown" class="jh-textarea" placeholder="Clique em &quot;Gerar Or√ßamento & Contrato&quot; para criar o Markdown automaticamente."></textarea>
          <button id="jh-copy" class="jh-btn-secondary" type="button">
            <span class="icon">üìã</span> Copiar or√ßamento (Markdown)
          </button>
        </div>
      </section>

      <!-- CONTRATO / MINUTA -->
      <section class="jh-section">
        <div class="jh-section-title">
          <span>‚óè</span> Contrato / Minuta autom√°tica
        </div>
        <div class="jh-grid">
          <textarea id="jh-contrato" class="jh-textarea" placeholder="Clique em &quot;Gerar Or√ßamento & Contrato&quot; para criar a minuta automaticamente."></textarea>
          <button id="jh-copy-contrato" class="jh-btn-secondary" type="button">
            <span class="icon">üìú</span> Copiar contrato
          </button>
        </div>
      </section>

      <!-- BOT√ÉO PRINCIPAL -->
      <button id="jh-generate" class="jh-btn-main" type="button">
        <span class="icon">‚ö°Ô∏è</span>
        <span>Gerar Or√ßamento & Contrato com jh-infodose</span>
      </button>

      <p class="jh-note">
        Esse m√≥dulo <strong>jh-infodose</strong> foi pensado pra encaixar direto no teu Livro Vivo, em PWA ou webview.  
        Gera o or√ßamento, cola o Markdown no Infod0x e usa a minuta como base contratual.
      </p>
    </div>
  </div>

  <script>
    (function () {
      function parseNumber(id) {
        const el = document.getElementById(id);
        if (!el) return 0;
        const v = parseFloat(String(el.value).replace(",", "."));
        return isNaN(v) ? 0 : v;
      }

      function formatBR(value) {
        return value.toLocaleString("pt-BR", {
          style: "currency",
          currency: "BRL"
        });
      }

      function gerarOrcamentoEContrato() {
        const modo = document.getElementById("jh-modo").value;

        const nomeEmpresa = document.getElementById("jh-nome-empresa").value.trim() || "EMPRESA DO CLIENTE";
        const localEmpresa = document.getElementById("jh-local").value.trim() || "Cidade/UF";
        const resumo = document.getElementById("jh-resumo").value.trim() ||
          "Cen√°rio operacional descrito com base na visita e nas informa√ß√µes do cliente.";

        const consultorNome = document.getElementById("jh-consultor-nome").value.trim() || "[NOME DO CONSULTOR / EMPRESA]";
        const consultorDoc = document.getElementById("jh-consultor-doc").value.trim() || "[CPF/CNPJ]";

        const hrSeg = parseNumber("jh-hr-seg");
        const horasSeg = parseNumber("jh-horas-seg");
        const hrCivil = parseNumber("jh-hr-civil");
        const horasCivil = parseNumber("jh-horas-civil");
        const setupInfodose = parseNumber("jh-setup-infodose");
        const mensal = parseNumber("jh-mensal");

        const totalSeg = hrSeg * horasSeg;
        const totalCivil = hrCivil * horasCivil;
        const totalDiagnostico = totalSeg + totalCivil + setupInfodose;
        const total3Meses = totalDiagnostico + mensal * 3;

        document.getElementById("jh-out-seg").textContent = formatBR(totalSeg);
        document.getElementById("jh-out-civil").textContent = formatBR(totalCivil);
        document.getElementById("jh-out-setup").textContent = formatBR(setupInfodose);
        document.getElementById("jh-out-total").textContent = formatBR(totalDiagnostico);
        document.getElementById("jh-out-total-3m").textContent = formatBR(total3Meses);

        // T√≠tulos din√¢micos conforme modo
        const tituloPrincipal =
          modo === "hora"
            ? "Or√ßamento T√©cnico ‚Äì Servi√ßos por Hora"
            : "Or√ßamento T√©cnico ‚Äì Pacote de Diagn√≥stico Integrado";

        const labelDiagnostico =
          modo === "hora"
            ? "Estimativa inicial (horas t√©cnicas + setup)"
            : "Diagn√≥stico inicial (sem mensalidade)";

        const textoModoResumo =
          modo === "hora"
            ? "Este or√ßamento est√° estruturado no modo **hora t√©cnica**, com possibilidade de setup Dual Infodose e plano mensal de acompanhamento."
            : "Este or√ßamento est√° estruturado no modo **pacote de diagn√≥stico integrado**, incluindo engenharia de seguran√ßa, engenharia civil e ativa√ß√£o Dual Infodose.";

        // MARKDOWN DO OR√áAMENTO
        const md = [
          `# ${tituloPrincipal}`,
          "## Engenharia de Seguran√ßa ¬∑ Engenharia Civil ¬∑ Dual Infodose",
          "",
          "::info",
          `Cliente (Contratante): **${nomeEmpresa}**`,
          `Local da opera√ß√£o: **${localEmpresa}**`,
          `Cen√°rio resumido: ${resumo}`,
          "",
          `Consultor(a) / Empresa (Contratada): **${consultorNome}**`,
          `Documento da contratada: ${consultorDoc}`,
          "::",
          "",
          "## 1. Estrutura do investimento",
          "",
          textoModoResumo,
          "",
          "### Engenharia de Seguran√ßa do Trabalho",
          `- Valor hora: ${hrSeg > 0 ? formatBR(hrSeg) : "a definir"} `,
          `- Horas previstas: ${horasSeg ? horasSeg.toString().replace(".", ",") + " h" : "a definir"}`,
          `- Total estimado: **${formatBR(totalSeg)}**`,
          "",
          "### Engenharia Civil",
          `- Valor hora: ${hrCivil > 0 ? formatBR(hrCivil) : "a definir"} `,
          `- Horas previstas: ${horasCivil ? horasCivil.toString().replace(".", ",") + " h" : "a definir"}`,
          `- Total estimado: **${formatBR(totalCivil)}**`,
          "",
          "### Dual Infodose + Livro Vivo",
          `- Setup Dual Infodose + modelo de relat√≥rio (Markdown / Infod0x + PDF): **${formatBR(setupInfodose)}**`,
          "",
          "::success",
          `**${labelDiagnostico}: ${formatBR(totalDiagnostico)}**`,
          "::",
          "",
          "### Acompanhamento mensal (opcional)",
          mensal > 0
            ? `- Valor mensal proposto: **${formatBR(mensal)}**`
            : "- Valor mensal: a definir de acordo com o plano escolhido.",
          mensal > 0
            ? `- Investimento total considerando 3 meses de acompanhamento: **${formatBR(total3Meses)}**`
            : "",
          "",
          "## 2. O que est√° inclu√≠do",
          "",
          "- Integra√ß√£o da vis√£o de Engenharia de Seguran√ßa do Trabalho (NRs, riscos, PGR, ergonomia) e Engenharia Civil (layout, circula√ß√£o, infraestrutura).",
          "- Coleta guiada de informa√ß√µes via fluxo Dual Infodose (gestores e colaboradores).",
          "- Consolida√ß√£o de dados em relat√≥rio **Livro Vivo**:",
          "  - Formato Markdown / Infod0x para edi√ß√£o cont√≠nua.",
          "  - Vers√£o PDF para envio e arquivamento formal.",
          "- Propostas iniciais de ajustes ergon√¥micos e plano de gin√°stica laboral alinhados com os riscos mapeados.",
          "",
          "## 3. Por que esse pacote / hora t√©cnica √© estrat√©gico",
          "",
          "::warn",
          "Sem essa integra√ß√£o, a empresa fica mais exposta a:",
          "",
          "- Multas e autua√ß√µes em fiscaliza√ß√µes trabalhistas e de seguran√ßa.",
          "- A√ß√µes trabalhistas por doen√ßas ocupacionais e acidentes.",
          "- Interdi√ß√£o de √°reas ou m√°quinas, parando a opera√ß√£o.",
          "- Perdas de produtividade por dor, afastamentos e rotatividade.",
          "::",
          "",
          "::info",
          "Com a combina√ß√£o **Engenharia + Dual Infodose**, o processo fica:",
          "",
          "- Menos burocr√°tico (fluxos guiados em linguagem simples).",
          "- Mais r√°pido (dados centralizados, relat√≥rios autom√°ticos).",
          "- Mais criativo (mais tempo de engenharia em solu√ß√£o, menos em papelada).",
          "::",
          "",
          "## 4. Pr√≥ximos passos",
          "",
          "- Aprovar este or√ßamento e confirmar o modo de contrata√ß√£o:",
          modo === "hora"
            ? "- **Servi√ßos por hora t√©cnica**, com emiss√£o de relat√≥rios conforme a evolu√ß√£o dos trabalhos."
            : "- **Pacote de diagn√≥stico integrado**, com entrega de relat√≥rio consolidado e plano de a√ß√£o.",
          "- Agendar a primeira visita t√©cnica e a ativa√ß√£o do painel Dual Infodose.",
          "- Iniciar o registro das primeiras evid√™ncias (fotos, relatos, medi√ß√µes, checklists).",
          "",
          "> Documento gerado pelo m√≥dulo **jh-infodose ¬∑ Or√ßamento Vivo** e pass√≠vel de atualiza√ß√£o conforme a realidade do projeto."
        ].join("\n");

        document.getElementById("jh-markdown").value = md;

        // CONTRATO / MINUTA
        const hoje = new Date();
        const dia = String(hoje.getDate()).padStart(2, "0");
        const ano = hoje.getFullYear();
        const meses = [
          "janeiro", "fevereiro", "mar√ßo", "abril", "maio", "junho",
          "julho", "agosto", "setembro", "outubro", "novembro", "dezembro"
        ];
        const mesNome = meses[hoje.getMonth()];

        const textoObjeto =
          modo === "hora"
            ? "presta√ß√£o de servi√ßos t√©cnicos profissionais de consultoria em Engenharia de Seguran√ßa do Trabalho e Engenharia Civil, com cobran√ßa baseada em hora t√©cnica, incluindo, quando contratado, a integra√ß√£o da plataforma Dual Infodose para coleta e organiza√ß√£o de dados e emiss√£o de relat√≥rios."
            : "presta√ß√£o de servi√ßos t√©cnicos profissionais de diagn√≥stico integrado em Engenharia de Seguran√ßa do Trabalho e Engenharia Civil, incluindo a ativa√ß√£o e uso da plataforma Dual Infodose para coleta de dados, elabora√ß√£o de relat√≥rio t√©cnico e apoio √† implementa√ß√£o de melhorias ergon√¥micas e de seguran√ßa.";

        const textoRemuneracao =
          modo === "hora"
            ? [
                "A remunera√ß√£o pelos servi√ßos ser√° composta por:",
                "",
                "- Hora t√©cnica de Engenharia de Seguran√ßa do Trabalho:",
                `  - Valor hora: ${hrSeg > 0 ? formatBR(hrSeg) : "a definir entre as partes"}.`,
                `  - Estimativa inicial de horas: ${horasSeg ? horasSeg.toString().replace(".", ",") + " h" : "a preencher conforme escopo detalhado."}`,
                "",
                "- Hora t√©cnica de Engenharia Civil:",
                `  - Valor hora: ${hrCivil > 0 ? formatBR(hrCivil) : "a definir entre as partes"}.`,
                `  - Estimativa inicial de horas: ${horasCivil ? horasCivil.toString().replace(".", ",") + " h" : "a preencher conforme escopo detalhado."}`,
                "",
                "- Setup Dual Infodose + modelo de relat√≥rio Livro Vivo:",
                `  - Valor: ${formatBR(setupInfodose)}.`,
                "",
                mensal > 0
                  ? `Opcionalmente, as partes poder√£o contratar plano de acompanhamento mensal no valor de ${formatBR(mensal)}, com escopo de horas e entregas definido em anexo espec√≠fico.`
                  : "Opcionalmente, as partes poder√£o contratar plano de acompanhamento mensal, com valores e escopo definidos em anexo espec√≠fico.",
                "",
                "Os valores acima poder√£o ser ajustados de comum acordo entre as partes, mediante registro em aditivo contratual ou proposta complementar."
              ].join("\n")
            : [
                "A remunera√ß√£o pelos servi√ßos ser√° composta por:",
                "",
                "- Pacote de diagn√≥stico integrado, incluindo:",
                "  - Visitas t√©cnicas, levantamentos e an√°lises em Engenharia de Seguran√ßa do Trabalho e Engenharia Civil;",
                "  - Integra√ß√£o com a plataforma Dual Infodose para coleta de dados;",
                "  - Elabora√ß√£o de relat√≥rio t√©cnico em formato Livro Vivo (Markdown / Infod0x) e vers√£o PDF.",
                "",
                `O valor de refer√™ncia para o diagn√≥stico inicial √© de ${formatBR(totalDiagnostico)}, considerando a combina√ß√£o de horas t√©cnicas e setup Dual Infodose.`,
                "",
                mensal > 0
                  ? `Caso o CONTRATANTE opte por acompanhamento cont√≠nuo, poder√° ser contratado plano mensal no valor de ${formatBR(mensal)}, com escopo detalhado em anexo.`
                  : "Caso o CONTRATANTE opte por acompanhamento cont√≠nuo, poder√° ser contratado plano mensal, com valores e escopo definidos em anexo.",
                "",
                "Os pagamentos ser√£o realizados conforme cronograma ou condi√ß√µes definidas na proposta comercial anexada a este instrumento."
              ].join("\n");

        const contrato = [
          "CONTRATO DE PRESTA√á√ÉO DE SERVI√áOS T√âCNICOS",
          "",
          "Pelo presente instrumento particular, de um lado:",
          "",
          `**CONTRATANTE:** ${nomeEmpresa}, com estabelecimento em ${localEmpresa}, doravante simplesmente denominada CONTRATANTE;`,
          "",
          `e, de outro lado, **CONTRATADA:** ${consultorNome}, inscrita sob ${consultorDoc}, doravante denominada CONTRATADA;`,
          "",
          "t√™m entre si justo e contratado o que segue:",
          "",
          "### CL√ÅUSULA 1 ‚Äì DO OBJETO",
          "",
          `1.1. O presente contrato tem por objeto a ${textoObjeto}`,
          "",
          "1.2. Os servi√ßos poder√£o abranger, entre outros:",
          "",
          "- Levantamento de riscos ocupacionais e requisitos legais aplic√°veis (NRs, laudos, PGR, ergonomia etc.);",
          "- Avalia√ß√£o de layout, circula√ß√£o, infraestrutura predial e condi√ß√µes de apoio √† opera√ß√£o;",
          "- Emiss√£o de relat√≥rios t√©cnicos, pareceres e recomenda√ß√µes para mitiga√ß√£o de riscos;",
          "- Apoio √† implementa√ß√£o de programas de gin√°stica laboral/ergon√¥mica, quando aplic√°vel;",
          "- Organiza√ß√£o e registro de dados por meio da plataforma Dual Infodose, com gera√ß√£o de relat√≥rios em formato Livro Vivo.",
          "",
          "### CL√ÅUSULA 2 ‚Äì DA VIG√äNCIA",
          "",
          "2.1. O presente contrato ter√° in√≠cio na data de sua assinatura e vigorar√° pelo prazo necess√°rio √† execu√ß√£o dos servi√ßos contratados,",
          "podendo ser prorrogado por meio de termo aditivo assinado pelas partes.",
          "",
          "2.2. Nos casos de contrata√ß√£o em car√°ter cont√≠nuo (hora t√©cnica / acompanhamento mensal), a vig√™ncia m√≠nima e as condi√ß√µes de renova√ß√£o",
          "ser√£o detalhadas na proposta comercial ou anexo espec√≠fico.",
          "",
          "### CL√ÅUSULA 3 ‚Äì DA REMUNERA√á√ÉO E FORMA DE PAGAMENTO",
          "",
          textoRemuneracao,
          "",
          "3.1. Os pagamentos ser√£o efetuados mediante emiss√£o de documento fiscal id√¥neo pela CONTRATADA, observando-se as normas tribut√°rias vigentes.",
          "",
          "3.2. Em caso de atraso superior a 15 (quinze) dias no pagamento, a CONTRATADA poder√° suspender a execu√ß√£o dos servi√ßos at√© a regulariza√ß√£o,",
          "sem preju√≠zo da incid√™ncia de juros, corre√ß√£o monet√°ria e demais penalidades previstas em lei.",
          "",
          "### CL√ÅUSULA 4 ‚Äì DAS RESPONSABILIDADES DAS PARTES",
          "",
          "4.1. Compete √† CONTRATADA:",
          "",
          "- Executar os servi√ßos com observ√¢ncia das normas t√©cnicas aplic√°veis e da legisla√ß√£o vigente;",
          "- Manter sigilo sobre informa√ß√µes t√©cnicas, comerciais e estrat√©gicas obtidas em fun√ß√£o da execu√ß√£o do contrato;",
          "- Esclarecer √† CONTRATANTE os limites de sua atua√ß√£o enquanto consultoria t√©cnica, n√£o assumindo responsabilidades operacionais diretas da empresa.",
          "",
          "4.2. Compete √† CONTRATANTE:",
          "",
          "- Fornecer informa√ß√µes verdadeiras e completas sobre a opera√ß√£o e os ambientes avaliados;",
          "- Garantir acesso √†s √°reas, documentos e colaboradores necess√°rios √† execu√ß√£o dos servi√ßos;",
          "- Implementar, sob sua responsabilidade, as a√ß√µes recomendadas, inclusive aquelas que dependam de decis√µes gerenciais e investimentos.",
          "",
          "### CL√ÅUSULA 5 ‚Äì DA RESCIS√ÉO",
          "",
          "5.1. O presente contrato poder√° ser rescindido por qualquer das partes, mediante aviso pr√©vio por escrito de, no m√≠nimo, 30 (trinta) dias,",
          "sem preju√≠zo da cobran√ßa dos servi√ßos j√° prestados at√© a data da rescis√£o.",
          "",
          "5.2. Constituem motivo para rescis√£o imediata:",
          "",
          "- Descumprimento grave das obriga√ß√µes aqui previstas;",
          "- Utiliza√ß√£o inadequada ou indevida dos relat√≥rios e pareceres t√©cnicos, em desacordo com sua finalidade.",
          "",
          "### CL√ÅUSULA 6 ‚Äì DO FORO",
          "",
          `6.1. Para dirimir quaisquer d√∫vidas oriundas deste contrato, as partes elegem o foro da comarca de ${localEmpresa},`,
          "com ren√∫ncia a qualquer outro, por mais privilegiado que seja.",
          "",
          "",
          `E, por estarem assim justas e contratadas, firmam o presente instrumento em 2 (duas) vias de igual teor e forma.`,
          "",
          `${localEmpresa}, ${dia} de ${mesNome} de ${ano}.`,
          "",
          "",
          "__________________________________________",
          `CONTRATANTE: ${nomeEmpresa}`,
          "",
          "__________________________________________",
          `CONTRATADA: ${consultorNome} ‚Äì ${consultorDoc}`
        ].join("\n");

        document.getElementById("jh-contrato").value = contrato;
      }

      function copyTextarea(id) {
        const ta = document.getElementById(id);
        if (!ta || !ta.value.trim()) return;
        ta.select();
        ta.setSelectionRange(0, ta.value.length);
        try {
          document.execCommand("copy");
        } catch (e) {
          console.warn("Falha ao copiar. Selecione e copie manualmente.", e);
        }
      }

      document.getElementById("jh-generate")?.addEventListener("click", gerarOrcamentoEContrato);
      document.getElementById("jh-copy")?.addEventListener("click", function () {
        copyTextarea("jh-markdown");
      });
      document.getElementById("jh-copy-contrato")?.addEventListener("click", function () {
        copyTextarea("jh-contrato");
      });
    })();
  </script>
</body>
</html>